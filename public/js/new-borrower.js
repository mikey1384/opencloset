// Generated by CoffeeScript 1.6.3
(function() {
  $(function() {
    var add_registered_guest, validation, why;
    $('#input-phone').ForceNumericOnly();
    add_registered_guest = function() {
      var compiled, data, html, query;
      query = $('#guest-search').val();
      data = {
        guest_id: query.length,
        guest_name: query
      };
      if (!query) {
        return;
      }
      if ($("#guest-search-list input[data-guest-id='" + data.guest_id + "']").length) {
        return;
      }
      compiled = _.template($('#tpl-new-borrower-guest-id').html());
      html = $(compiled(data));
      return $("#guest-search-list").append(html);
    };
    $('#guest-search').keypress(function(e) {
      if (e.keyCode === 13) {
        return add_registered_guest();
      }
    });
    $('#btn-guest-search').click(function() {
      return add_registered_guest();
    });
    $('.clickable.label').click(function() {
      return $('#input-purpose').val($(this).text());
    });
    $('#input-target-date').datepicker({
      startDate: "-0d",
      language: 'kr',
      format: 'yyyy-mm-dd',
      autoclose: true
    });
    $('#btn-sendsms:not(.disabled)').click(function(e) {
      var $this, to;
      e.preventDefault();
      $this = $(this);
      $this.addClass('disabled');
      to = $('#input-phone').val();
      if (!to) {
        return;
      }
      return $.ajax("/sms.json", {
        type: 'POST',
        data: {
          to: to
        },
        success: function(data, textStatus, jqXHR) {
          return alert('success', "" + to + " 번호로 SMS 가 발송되었습니다");
        },
        error: function(jqXHR, textStatus, errorThrown) {
          return alert('error', jqXHR.responseJSON.error);
        },
        complete: function(jqXHR, textStatus) {
          return $this.removeClass('disabled');
        }
      });
    });
    validation = false;
    $('#fuelux-wizard').ace_wizard().on('change', function(e, info) {
      if (info.step === 1 && validation) {
        if (!$('#validation-form').valid()) {
          return false;
        }
      }
    }).on('finished', function(e) {
      return false;
    }).on('stepclick', function(e) {});
    why = $('#guest-why').tag({
      placeholder: $('#guest-why').attr('placeholder'),
      source: ['입사면접', '사진촬영', '결혼식', '장례식', '입학식', '졸업식', '세미나', '발표']
    });
    return $('.guest-why .clickable.label').click(function() {
      var e, text;
      text = $(this).text();
      e = $.Event('keydown', {
        keyCode: 13
      });
      return why.next().val(text).trigger(e);
    });
  });

}).call(this);
