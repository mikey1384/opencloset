// Generated by CoffeeScript 1.6.3
(function() {
  $(function() {
    var origin_fee, overdue_calc;
    origin_fee = $('#input-price').val() || 0;
    $('#input-target-date').datepicker({
      format: 'yyyy-mm-dd',
      autoclose: true,
      startDate: new Date(),
      language: 'kr'
    }).on('changeDate', function(e) {
      var additional_days, additional_fee;
      additional_days = overdue_calc(new Date(), $('#input-target-date').datepicker('getDate'));
      console.log(additional_days);
      additional_fee = additional_days * origin_fee * 0.2;
      return $('#input-price').val(parseInt(origin_fee) + parseInt(additional_fee));
    });
    overdue_calc = function(target_dt, return_dt) {
      var DAY_AS_SECONDS, dur;
      DAY_AS_SECONDS = 60 * 60 * 24;
      dur = return_dt.getTime() - (DAY_AS_SECONDS * 1000 * 2) - target_dt.getTime();
      if (dur < 0) {
        return 0;
      }
      return parseInt(dur / 1000 / DAY_AS_SECONDS);
    };
    return $('#btn-order-cancel:not(.disabled)').click(function(e) {
      var $this;
      e.preventDefault();
      $this = $(this);
      $this.addClass('disabled');
      return $.ajax("" + ($this.attr('href')) + ".json", {
        type: 'DELETE',
        dataType: 'json',
        success: function(data, textStatus, jqXHR) {
          _alert('주문이 취소 되었습니다');
          return location.href = '/';
        },
        error: function(jqXHR, textStatus, errorThrown) {
          return alert('error', jqXHR.responseJSON.error);
        },
        complete: function(jqXHR, textStatus) {
          return $this.removeClass('disabled');
        }
      });
    });
  });

}).call(this);
