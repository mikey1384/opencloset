// Generated by CoffeeScript 1.7.1
(function() {
  $(function() {
    var beforeSendSMS, visitError;
    $("#btn-service-disagree").click(function(e) {
      $("input[name=service]").prop("checked", false);
      $("#modal-service .modal-body").scrollTop(0);
      return $("#modal-service").modal('hide');
    });
    $("#btn-service-agree").click(function(e) {
      $("input[name=service]").prop("checked", true);
      $("#modal-service .modal-body").scrollTop(0);
      return $("#modal-service").modal('hide');
    });
    $("input[name=service]").click(function(e) {
      if ($(this).prop("checked")) {
        $(this).prop("checked", false);
        return $("#modal-service").modal('show');
      }
    });
    $("#btn-privacy-disagree").click(function(e) {
      $("input[name=privacy]").prop("checked", false);
      $("#modal-privacy .modal-body").scrollTop(0);
      return $("#modal-privacy").modal('hide');
    });
    $("#btn-privacy-agree").click(function(e) {
      $("input[name=privacy]").prop("checked", true);
      $("#modal-privacy .modal-body").scrollTop(0);
      return $("#modal-privacy").modal('hide');
    });
    $("input[name=privacy]").click(function(e) {
      if ($(this).prop("checked")) {
        $(this).prop("checked", false);
        return $("#modal-privacy").modal('show');
      }
    });
    visitError = function(msg) {
      $('#visit-alert').prepend("<div class=\"alert alert-danger\"><button class=\"close\" type=\"button\" data-dismiss=\"alert\">&times;</button>" + msg + "</div>");
      return setTimeout(function() {
        return $('.alert').remove();
      }, 3000);
    };
    beforeSendSMS = function() {
      $(".sms").removeClass('block').hide();
      $("#btn-sms-confirm-label").html('SMS 인증번호 전송');
      return $("#btn-sms-confirm").prop("disabled", false);
    };
    beforeSendSMS();
    $('#btn-sms-reset').click(function(e) {
      return beforeSendSMS();
    });
    return $('#btn-sms-confirm').click(function(e) {
      var name, phone, privacy, service, sms, timer, validate_end;
      e.preventDefault();
      name = $("input[name=name]").val();
      phone = $("input[name=phone]").val();
      service = $("input[name=service]").prop("checked");
      privacy = $("input[name=privacy]").prop("checked");
      sms = $("input[name=sms]").val();
      if (name && phone && service && privacy && sms) {
        return $('#visit-form').submit();
      } else {
        if (!name) {
          visitError('이름을 입력해주세요.');
          return;
        }
        if (!phone) {
          visitError('휴대전화를 입력해주세요.');
          return;
        }
        if (!service) {
          visitError('서비스 이용약관을 확인해주세요.');
          return;
        }
        if (!privacy) {
          visitError('개인정보 이용안내를 확인해주세요.');
          return;
        }
        $(".sms").addClass('block').show();
        $("#btn-sms-confirm-label").html('SMS 인증하기');
        validate_end = moment().add('m', 3);
        $("#sms-remain-seconds").html(validate_end.diff(moment(), 'seconds'));
        return timer = setInterval(function() {
          var validate_remain;
          validate_remain = validate_end.diff(moment(), 'seconds');
          if (validate_remain > 0) {
            return $("#sms-remain-seconds").html(validate_remain);
          } else {
            $("#sms-remain-seconds").html(0);
            $("#btn-sms-confirm").prop("disabled", true);
            return clearInterval(timer);
          }
        }, 500);
      }
    });
  });

}).call(this);
